const XLSX = require('xlsx');

const testFeeders = [
  {
    'Serial No': 1,
    'Cable Number': 'C001',
    'Feeder Description': 'Boiler Feed Pump Motor 1',
    'From Bus': 'MCC-1',
    'To Bus': 'BFP-MOTOR-1',
    'Voltage (V)': 6600,
    'Load KW': 500,
    'Length (m)': 150,
    'Phase': '3Ø',
    'Load Type': 'Pump',
    'Efficiency': 0.925,
    'Power Factor': 0.88,
    'Starting Method': 'SoftStarter',
    'Material': 'Cu',
    'Insulation': 'XLPE',
    'Number of Cores': '3C+E',
    'Installation Method': 'Air - Ladder tray (touching)',
    'Cable Spacing': 'touching',
    'Ambient Temp (°C)': 40,
    'Soil Thermal Resistivity (K·m/W)': 1.2,
    'Depth of Laying (cm)': 60,
    'Grouped Loaded Circuits': 4,
    'Max SC Current (kA)': 25,
    'Derating Factor': 0.87
  },
  {
    'Serial No': 2,
    'Cable Number': 'C002',
    'Feeder Description': 'Cooling Tower Fan Motor A',
    'From Bus': 'MCC-2',
    'To Bus': 'CT-FAN-A',
    'Voltage (V)': 415,
    'Load KW': 45,
    'Length (m)': 85,
    'Phase': '3Ø',
    'Load Type': 'Fan',
    'Efficiency': 0.90,
    'Power Factor': 0.85,
    'Starting Method': 'StarDelta',
    'Material': 'Cu',
    'Insulation': 'XLPE',
    'Number of Cores': '3C+E',
    'Installation Method': 'Air - Conduit (single)',
    'Cable Spacing': 'touching',
    'Ambient Temp (°C)': 45,
    'Soil Thermal Resistivity (K·m/W)': 1.2,
    'Depth of Laying (cm)': 60,
    'Grouped Loaded Circuits': 3,
    'Max SC Current (kA)': 15,
    'Derating Factor': 0.87
  },
  {
    'Serial No': 3,
    'Cable Number': 'C003',
    'Feeder Description': 'Heater Load - Preheating',
    'From Bus': 'MCC-4',
    'To Bus': 'HEATER-1',
    'Voltage (V)': 415,
    'Load KW': 120,
    'Length (m)': 200,
    'Phase': '3Ø',
    'Load Type': 'Heater',
    'Efficiency': 0.99,
    'Power Factor': 1.0,
    'Starting Method': 'DOL',
    'Material': 'Cu',
    'Insulation': 'XLPE',
    'Number of Cores': '3C+E',
    'Installation Method': 'Air - Ladder tray (touching)',
    'Cable Spacing': 'spaced_400mm',
    'Ambient Temp (°C)': 50,
    'Soil Thermal Resistivity (K·m/W)': 1.2,
    'Depth of Laying (cm)': 60,
    'Grouped Loaded Circuits': 2,
    'Max SC Current (kA)': 12,
    'Derating Factor': 0.87
  },
  {
    'Serial No': 4,
    'Cable Number': 'C004',
    'Feeder Description': 'Air Compressor Motor',
    'From Bus': 'MCC-3',
    'To Bus': 'COMPRESSOR-1',
    'Voltage (V)': 415,
    'Load KW': 22,
    'Length (m)': 120,
    'Phase': '3Ø',
    'Load Type': 'Compressor',
    'Efficiency': 0.885,
    'Power Factor': 0.82,
    'Starting Method': 'VFD',
    'Material': 'Cu',
    'Insulation': 'XLPE',
    'Number of Cores': '3C+E',
    'Installation Method': 'Air - Conduit (single)',
    'Cable Spacing': 'touching',
    'Ambient Temp (°C)': 40,
    'Soil Thermal Resistivity (K·m/W)': 1.2,
    'Depth of Laying (cm)': 60,
    'Grouped Loaded Circuits': 3,
    'Max SC Current (kA)': 12,
    'Derating Factor': 0.87
  },
  {
    'Serial No': 5,
    'Cable Number': 'C005',
    'Feeder Description': 'Transformer Feeder',
    'From Bus': 'MAIN-BUS',
    'To Bus': 'TR-1',
    'Voltage (V)': 6600,
    'Load KW': 1200,
    'Length (m)': 200,
    'Phase': '3Ø',
    'Load Type': 'Transformer',
    'Efficiency': 0.97,
    'Power Factor': 0.95,
    'Starting Method': 'DOL',
    'Material': 'Cu',
    'Insulation': 'XLPE',
    'Number of Cores': '3C+E',
    'Installation Method': 'Buried in concrete',
    'Cable Spacing': 'spaced_600mm',
    'Ambient Temp (°C)': 35,
    'Soil Thermal Resistivity (K·m/W)': 1.5,
    'Depth of Laying (cm)': 80,
    'Grouped Loaded Circuits': 2,
    'Max SC Current (kA)': 35,
    'Derating Factor': 0.75
  }
];

const ws = XLSX.utils.json_to_sheet(testFeeders);
const wb = XLSX.utils.book_new();
XLSX.utils.book_append_sheet(wb, ws, 'Feeders');
XLSX.writeFile(wb, 'test_demo_feeders.xlsx');

console.log('✅ Created test_demo_feeders.xlsx with 5 sample feeders');
